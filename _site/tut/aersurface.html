<h1 id="aermod-aersurface">Aermod: AERSURFACE</h1>

<blockquote>
  <p>Tutorial para el preprocesamiento de datos de superficie aermod (<strong>AERSURFACE</strong>)</p>
</blockquote>

<p>El <strong>AERSURFACE</strong> es un preprocesador que nos permite estimar parámetros de superficie representativos para las cercanías de la estación meteorológica, usando datos de usos de suelo, canopeo e impermeabilidad del suelo. Es una herramienta “opcional” y no es requisito de EPA su utilización en modelado regulatorio.
Este programa relaciona una clasificación de cobertura del suelo (pastizal, urbano, agua), a una distancia de la estación meteorológica de superficie, para inferir los siguientes parámetros:</p>

<ol>
  <li>albedo α</li>
  <li>proporción (ratio) de bowen $B_{0}$</li>
  <li>longitud de rugosidad de superficie $z_{0}$</li>
</ol>

<p>Este programa necesita datos que requieren un formato de clasificación particular del servicio geológico de estados unidos (<a href="https://www.mrlc.gov/">NLCD</a>) y que en consecuencia no esta disponible en nuestro país.</p>

<p>Esta clasificación de cobertura del suelo el USGS define las siguientes clases:</p>

<!-- https://grasswiki.osgeo.org/wiki/File:NLCD_2016_Land_Cover_example.png -->
<p>|Clase|Descripción|
|—|—|
|11|Open Water|
|12|Perennial Snow/Ice|
|21|Developed, Open Space|
|22|Developed, Low Intensity|
|23|Developed, Medium Intensity|
|24|Developed, High Intensity|
|31|Barren Land|
|41|Deciduous Forest|
|42|Evergreen Forest|
|43|Mixed Forest|
|52|Shrub/Scrub|
|71|Herbaceous|
|81|Hay/Pasture|
|82|Cultivated Crops|
|90|Woody Wetlands|
|95|Emergent Herbaceous Wetlands|</p>

<p>Asi se visualiza la clasificación de cobertura para un aeropuerto de estados unidos.</p>

<p><img src="/tut/imgs/aersurf_pizza.png" alt="" /></p>

<p><img src="/tut/imgs/aersurf_pizza_nlcd.png" alt="" /></p>

<p>Para determinar la clase dominante y sus parámetros asociados se debe analizar la siguiente información.</p>

<ol>
  <li>albedo α:
    <ul>
      <li>Media <em>aritmética</em> de región de 10 km x 10 km centrada en la estación meteorológica.</li>
    </ul>
  </li>
  <li>proporción (ratio) de bowen $B_{0}$
    <ul>
      <li>Media <em>geométrica</em> de región de 10 km x 10 km centrada en la estación meteorológica.</li>
    </ul>
  </li>
  <li>longitud de rugosidad de superficie $z_{0}$
    <ul>
      <li>En un radio de 1km a la estación meteorológica, se deben analizar 12 direcciones del viento o secciones de 30°. A cada sección se asigna como $z_{0}$ la media geométrica del valor de rugosidad ponderado de forma inversa a la distancia a la estación.</li>
    </ul>
  </li>
</ol>

<p>Entonces se podrían visualizar a continuación, las dos áreas analizadas. <br />
<img src="imgs/aersurface_radio.png" alt="aersurface_radio" /></p>

<p>Cada sección va a representar una cobertura distinta, con parámetros de albedo, bowen y rugosidad distintas. En el anexo A de la guía de usuario de <em>AERSURFACE</em> se listan las tablas completas, a los fines de este tutorial, vamos a extraer y simplificar la información de algunas clases.</p>

<table>
  <thead>
    <tr>
      <th>Clase</th>
      <th>Descripción</th>
      <th>$B_{0}$ verano</th>
      <th>$B_{0}$ otoño</th>
      <th>$B_{0}$ invierno</th>
      <th>$B_{0}$ primavera</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>21</td>
      <td>Low Intensity Residential</td>
      <td>0.8</td>
      <td>1</td>
      <td>1</td>
      <td>0.8</td>
    </tr>
    <tr>
      <td>22</td>
      <td>High Intensity Residential</td>
      <td>1.5</td>
      <td>1.5 1.5</td>
      <td>1.5</td>
      <td> </td>
    </tr>
    <tr>
      <td>23</td>
      <td>Commercial/Industrial/Transp (Site at Airport)</td>
      <td>1.5</td>
      <td>1.5</td>
      <td>1.5</td>
      <td>1.5</td>
    </tr>
    <tr>
      <td>85</td>
      <td>Urban/Recreational Grasses</td>
      <td>0.5</td>
      <td>0.7</td>
      <td>0.7</td>
      <td>0.3</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Clase</th>
      <th>Descripción</th>
      <th>albedo α verano</th>
      <th>albedo α otoño</th>
      <th>albedo α invierno</th>
      <th>albedo α primavera</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>21</td>
      <td>Low Intensity Residential</td>
      <td>0.16</td>
      <td>0.16</td>
      <td>0.18</td>
      <td>0.16</td>
    </tr>
    <tr>
      <td>22</td>
      <td>High Intensity Residential</td>
      <td>0.18</td>
      <td>0.18</td>
      <td>0.18</td>
      <td>0.18</td>
    </tr>
    <tr>
      <td>23</td>
      <td>Commercial/Industrial/Transp (Site at Airport)</td>
      <td>0.18</td>
      <td>0.18</td>
      <td>0.18</td>
      <td>0.18</td>
    </tr>
    <tr>
      <td>85</td>
      <td>Urban/Recreational Grasses</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.18</td>
      <td>0.15</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Clase</th>
      <th>Descripción</th>
      <th>$z_{0}$ verano</th>
      <th>$z_{0}$ otoño</th>
      <th>$z_{0}$ invierno</th>
      <th>$z_{0}$ primavera</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>21</td>
      <td>Low Intensity Residential</td>
      <td>0.54</td>
      <td>0.54</td>
      <td>0.5</td>
      <td>0.52</td>
    </tr>
    <tr>
      <td>22</td>
      <td>High Intensity Residential</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>23</td>
      <td>Commercial/Industrial/Transp (Site at Airport)</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>0.1</td>
    </tr>
    <tr>
      <td>85</td>
      <td>Urban/Recreational Grasses</td>
      <td>0.02</td>
      <td>0.015</td>
      <td>0.01</td>
      <td>0.015</td>
    </tr>
  </tbody>
</table>

<p>Por ejemplo, para el caso de EZEIZA AERO, las áreas a analizar serían las siguientes:
<img src="/tut/imgs/saez_al_bow_zo.png" alt="" /></p>

<p>En cuanto a cobertura, la mejor fuente de información disponible hasta el momento es la <a href="https://land.copernicus.eu/global/content/annual-100m-global-land-cover-maps-available">clasificación de la agencia espacial europea</a> con resolución de 100mx100m y uso de clases de la FAO en vez del servicio geológico de estados unidos.</p>

<p><img src="imgs/saez_al_bow_zo_GLC.png" alt="" /></p>

<p>Ante la falta de capas de cobertura en el formato requerido, debemos
generar esta información a partir del procesamiento realizado por el usuario.</p>

<p>Vamos a crear un archivo de texto llamado <code class="language-plaintext highlighter-rouge">AERSURFACE.OUT</code> y completaremos la siguiente información.</p>

<p>Como las propiedades de superficie pueden cambiar en el tiempo, se debe aclarar la resolución temporal: mensual, estacional ó anualmente.</p>

<p>La palabra clave <code class="language-plaintext highlighter-rouge">FREQ_SECT</code> permite definir como queremos que cambien los parámetros de superficie en el tiempo: (<code class="language-plaintext highlighter-rouge">ANNUAL</code>, <code class="language-plaintext highlighter-rouge">SEASONAL</code> ó <code class="language-plaintext highlighter-rouge">MONTHLY</code>)  y el numero de sectores con superficies distintas alrededor de la estación meteorológica. Para el ejemplo hemos elegido <code class="language-plaintext highlighter-rouge">SEASONAL</code> y escribimos la siguiente primera línea.</p>

<pre><code class="language-Text"> FREQ_SECT  SEASONAL  1
</code></pre>

<p>Con la keyword <code class="language-plaintext highlighter-rouge">SECTOR</code> se define para cada sector cual es el ángulo de inicio y fin que lo define. Siempre considerando que el 0 se encuentra en el norte, y que avanza de forma horaria. Para este ejemplo tomamos todas las direcciones del viento como un solo sector.</p>
<pre><code class="language-Text">   SECTOR   1  0   360
</code></pre>

<p>Por último para cada sector y cada estación del año (<em>season</em>) hay que definir los valores de albedo, bowen y rugosidad usando la <em>keyword</em>: <code class="language-plaintext highlighter-rouge">SITE_CHAR</code>.
 Vamos a asumir que todos los parámetros corresponden a la clase <em>“21 - Low intensity residential”</em>.
Los parámetros elegidos en este ejemplo se tomaron de las tablas anteriores según las estaciones del año y deben invertirse ya que están definidas para el hemisferio norte.</p>

<table>
  <thead>
    <tr>
      <th>Nro estación #</th>
      <th>Estación</th>
      <th>Meses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Invierno HN</td>
      <td>diciembre, enero, febrero</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Primavera HN</td>
      <td>marzo, abril, mayo</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Verano HN</td>
      <td>junio, julio, agosto</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Otoño HN</td>
      <td>septiembre, octubre, noviembre</td>
    </tr>
  </tbody>
</table>

<p>Para esta entrada, vamos a agregar un formato de tabla, con un fin de organizar visualmente la información, <code class="language-plaintext highlighter-rouge">**</code> convierte la línea en un comentario, y por lo tanto no tiene ningún efecto. 
Buscamos para cada “estación” los valores de superficie para la case 21.</p>

<table>
  <thead>
    <tr>
      <th>Clase</th>
      <th>Descripción</th>
      <th>albedo α verano</th>
      <th>albedo α otoño</th>
      <th>albedo α invierno</th>
      <th>albedo α primavera</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>21</td>
      <td>Low Intensity Residential</td>
      <td>0.16</td>
      <td>0.16</td>
      <td>0.18</td>
      <td>0.16</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Clase</th>
      <th>Descripción</th>
      <th>$B_{0}$ verano</th>
      <th>$B_{0}$ otoño</th>
      <th>$B_{0}$ invierno</th>
      <th>$B_{0}$ primavera</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>21</td>
      <td>Low Intensity Residential</td>
      <td>0.8</td>
      <td>1</td>
      <td>1</td>
      <td>0.8</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Clase</th>
      <th>Descripción</th>
      <th>$z_{0}$ verano</th>
      <th>$z_{0}$ otoño</th>
      <th>$z_{0}$ invierno</th>
      <th>$z_{0}$ primavera</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>21</td>
      <td>Low Intensity Residential</td>
      <td>0.54</td>
      <td>0.54</td>
      <td>0.5</td>
      <td>0.52</td>
    </tr>
  </tbody>
</table>

<pre><code class="language-Text">**------------------------------------------------|
**          | season | section | a0  | b0  | z0   |
**----------|--------|---------|-----|-----|------|
   SITE_CHAR    1        1      0.16  0.80  0.54
   SITE_CHAR    2        1      0.16  1.00  0.54
   SITE_CHAR    3        1      0.18  1.00  0.50
   SITE_CHAR    4        1      0.16  0.80  0.52
**----------|--------|---------|-----|-----|------|
</code></pre>

<p>El contenido final de  <code class="language-plaintext highlighter-rouge">AERSURFACE.OUT</code> debería ser el siguiente:</p>

<pre><code class="language-Text"> FREQ_SECT  SEASONAL  1
   SECTOR   1  0   360
**------------------------------------------------|
**          | season | section | a0  | b0  | z0   |
**----------|--------|---------|-----|-----|------|
   SITE_CHAR    1        1      0.16  0.80  0.54
   SITE_CHAR    2        1      0.16  1.00  0.54
   SITE_CHAR    3        1      0.18  1.00  0.50
   SITE_CHAR    4        1      0.16  0.80  0.52
**----------|--------|---------|-----|-----|------|
</code></pre>
